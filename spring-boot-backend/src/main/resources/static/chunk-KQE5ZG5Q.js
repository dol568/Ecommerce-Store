import{a as u,e as _,f as k,g as I,h as x}from"./chunk-VRCW3ZRF.js";import{f as S,j as b}from"./chunk-HLRN3ODD.js";import{X as d,ba as m,d as s,e as p,f as h,m as f,t as a,xc as g,zc as U}from"./chunk-HJS56J6Z.js";var z=(()=>{var o,n;let i=class i{constructor(){p(this,o,void 0);p(this,n,void 0);h(this,o,m(U)),h(this,n,m(S)),this.baseUrl=u+_,this.currentUserSource=new f(null),this.currentUser$=this.currentUserSource.asObservable()}loadCurrentUser(t){if(t===null)return this.currentUserSource.next(null),null;let e=new g;return e=e.set("Authorization",`Bearer ${t}`),s(this,o).get(this.baseUrl,{headers:e}).pipe(a(r=>{let c=r.data;c&&(localStorage.setItem("token",c.token),this.currentUserSource.next(c))}))}login(t){return s(this,o).post(u+k,t).pipe(a(e=>{let r=e.data;r&&(localStorage.setItem("token",r.token),this.currentUserSource.next(r))}))}register(t){return s(this,o).post(u+I,t).pipe(a(e=>{let r=e.data;r&&(localStorage.setItem("token",r.token),this.currentUserSource.next(r))}))}logout(){localStorage.removeItem("token"),this.currentUserSource.next(null),s(this,n).navigate([b])}address$(){return s(this,o).get(this.baseUrl+x).pipe(a(t=>t.data))}};o=new WeakMap,n=new WeakMap,i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let l=i;return l})();export{z as a};
